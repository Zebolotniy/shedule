<!doctype html>
<html lang="ru">
<head>
  <link rel="apple-touch-icon" sizes="57x57" href="img/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="img/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="img/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="img/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="img/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="img/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="img/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="img/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="img/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="img/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="img/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="img/favicon-16x16.png">
  <link rel="manifest" href="manifest.json">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="application-name" content="Расписание">
  <meta name="apple-mobile-web-app-title" content="Расписание">
  <meta name="msapplication-starturl" content="/">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="img/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Расписание РТУ МИРЭА</title>
  <link rel="stylesheet" href="shedule.css"/>
</head>
<body>
  <div class="iface-centered">
    <div class="shedule-bg">
      <div class="head">
        <div class="head-menu">
          <img src="img/Group 5.png" style="scale: .7;">
          <div>Меню</div>
        </div>
        <div class="head-title">Расписание РТУ МИРЭА группа КББО-01-20</div>
        <div></div>
      </div>
      <div class="shedule">
        <div class="shedule-head">
          <div class="arrow_a"><img src="img/Arrow 2.png"></div>
          <div id="date">Экзаменационная сессия</div>
          <div class="arrow_b"><img src="img/Arrow 2.png"></div>
        </div>
        <div class="shedule-table">
          <div id="monday">
            <div class="shedule-day">
              <!-- <a href="#mnd">Понедельник</a> -->
              <div>Расписание экзаменов</div>
            </div>
            <div class="shedule-list">
              <div class="shedule-value val_col">
                <div>Дата</div>
                <div>Время</div>
                <div>Вид</div>
                <div>Предмет</div>
                <div>Преподаватель</div>
                <div>Аудитория</div>
              </div>
              <div class="shedule-value">
                <div>9 января</div>
                <div>13:00</div>
                <div>К</div>
                <div>Медицинские базы данных и экспертные системы</div>
                <div>Куликов А.А.</div>
                <div>А-7</div>
              </div>
              <div class="shedule-value">
                <div>11 января</div>
                <div>12:00</div>
                <div>Э</div>
                <div>Медицинские базы данных и экспертные системы</div>
                <div>Куликов А.А.</div>
                <div>А-177-1</div>
              </div>
              <div class="shedule-value">
                <div>13 января</div>
                <div>11:00</div>
                <div>К</div>
                <div>Численные методы решения уравнений математической физики</div>
                <div>Гольцов А.Н.</div>
                <div>А-5</div>
              </div>
              <div class="shedule-value">
                <div>16 января</div>
                <div>9:00</div>
                <div>Э</div>
                <div>Численные методы решения уравнений математической физики</div>
                <div>Гольцов А.Н.</div>
                <div>Г-322-в</div>
              </div>
              <div class="shedule-value">
                <div>18 января</div>
                <div>9:00</div>
                <div>К</div>
                <div>Медицинские датчики и электроды</div>
                <div>Саидгазиев А.Ш.</div>
                <div>А-5</div>
              </div>
              <div class="shedule-value">
                <div>20 января</div>
                <div>11:00</div>
                <div>Э</div>
                <div>Медицинские датчики и электроды</div>
                <div>Саидгазиев А.Ш.</div>
                <div>Г-322-в</div>
              </div>
              <div class="shedule-value">
                <div>24 января</div>
                <div>11:00</div>
                <div>К</div>
                <div>Моделирование биологических процессов и систем</div>
                <div>Каданцев В.Н.</div>
                <div>А-5</div>
              </div>
              <div class="shedule-value">
                <div>26 января</div>
                <div>9:00</div>
                <div>Э</div>
                <div>Моделирование биологических процессов и систем</div>
                <div>Каданцев В.Н.</div>
                <div>Г-320</div>
              </div>
              <div class="shedule-value">
                <div>28 января</div>
                <div>13:00</div>
                <div>К</div>
                <div>Микропроцессорные устройства в биотехнических системах</div>
                <div>Мошкин В.В.</div>
                <div>А-5</div>
              </div>
              <div class="shedule-value">
                <div>30 января</div>
                <div>11:00</div>
                <div>Э</div>
                <div>Микропроцессорные устройства в биотехнических системах</div>
                <div>Мошкин В.В.</div>
                <div>Г-424-1</div>
              </div>
            </div>
          </div>
        </div>
        <div class="shedule-footer">
          <a href="https://www.mirea.ru/schedule/"><div class="ticket-barcode" id="barcode"></div></a>
          <div class="ticket-code" id="ticket-code"></div>
        </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    let a = new Date();
    a = new Date(a.getFullYear(), a.getMonth(), a.getDate());
    let b = new Date(2022, 7, 28);
    let week = Math.ceil((a.getTime()-b.getTime())/1000/3600/24/7);
    let d = 0;
    let d_names = ["monday", "tuesday", "wednesday", "thursday", "friday", "saturday"];
    if(a.getDay() == 0){ d = 7; }
    else{ d = a.getDay(); }
    let start = new Date(a.getFullYear(), a.getMonth(), a.getDate()-d+1);
    let finish = new Date(a.getFullYear(), a.getMonth(), a.getDate()+7-d);
    function setWeek(start, finish)
    {
      date.innerHTML = week + " неделя  " + start.getDate() + "." + (start.getMonth() + 1) + "." + start.getFullYear() +
      "-" + finish.getDate() + "." + (finish.getMonth() + 1) + "." + finish.getFullYear();
    }
    if(0)
    {
      setWeek(start, finish);
      window.addEventListener("load", setDays);
    }
    let days;
    let dayshedule;
    function HighlightExamDay(day, mo){
      days = document.getElementsByClassName("shedule-value");
      for(let i = 0; i < days.length; i++)
      {
        if(parseInt(days[i].children[0].innerHTML.split(' ')[0]) == day && mo)
        {
          days[i].setAttribute('style','background-color: #d1c9cc; color: #fff;');
        }
      }
    }
    mo = a.getMonth()+1 == 1;
    HighlightExamDay(a.getDate(), mo);
    function setDays(){
    days = document.getElementsByClassName("shedule-day");
    dayshedule = document.getElementsByClassName("shedule-list");
    for(let i = 0; i< days.length; i++)
    {
      days[i].addEventListener("click", function(){
        if(dayshedule[i].style.display == "block"){
          dayshedule[i].style.display = "none";
        }
        else{
          dayshedule[i].style.display = "block";
          location.href = "#" + d_names[i];
        }
      });
    }
    setTimeout(open_day, 200);
    }
    function open_day(){
      let k = d-1;
      let p = 0;
      if(d == 7){
        dayshedule[0].style.display = "block";
        location.href = "#" + d_names[0];
        return;
      }
      let classes = dayshedule[k].getElementsByClassName("shedule-value");
      let fin_h = classes[classes.length-1].getElementsByTagName("div")[1].innerHTML;
      fin_h = fin_h.slice(fin_h.indexOf("-")+1);
      let fin_m = fin_h.slice(fin_h.indexOf(":")+1);
      fin_h = fin_h.slice(0,fin_h.indexOf(":"));
      console.log(fin_h + "-" + fin_m);
      let c_d = new Date();
      if(c_d.getHours() > fin_h || (c_d.getMinutes() > fin_m && c_d.getHours() == fin_h)){
        k = d;
        if(k > 5){k =0;}
        console.log(k + " ," + c_d.getHours() + ":" + c_d.getMinutes());
      }
      else{
        k = d-1;
      }
      dayshedule[k].style.display = "block";
      location.href = "#" + d_names[k];
    }
    document.getElementById("ticket-code").innerHTML="mirea.ru/schedule";
    for (let i = 0; i<80; i++){
      let bc = document.createElement("div");
      bc.style.width = barcodeItemWidth() + "px";
      document.getElementById("barcode").appendChild(bc);
    }
    function barcodeItemWidth(){
      const t=3*Math.random();
      return t<1?1:t
    }
    if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {  
   navigator.serviceWorker.register('sw.js').then(
     function(registration) {
       // Registration was successful
       console.log('ServiceWorker registration successful with scope: ', registration.scope); },
     function(err) {
       // registration failed :(
       console.log('ServiceWorker registration failed: ', err);
     });
 });
}
  </script>
</body>
</html>
